
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Move cube. 11 lesson Three.js </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <style>
            body {
                background-color: #000000;
                margin: 0px;
                overflow: hidden;
            }

            a {
                color:#0078ff;
            }

            #info {
                position: absolute;
                top: 10px; width: 100%;
                color: #ffffff;
                padding: 5px;
                font-family: Monospace;
                font-size: 13px;
                text-align: center;
                z-index:100;
            }

            a {
                color: orange;
                text-decoration: none;
            }

            a:hover {
                color: #0080ff;
            }

        </style>
    </head>
    <body>


<script src="../libraries/three.js-r87/build/three.js"></script>
<script src="../libraries/three.js-r87/examples/js/geometries/hilbert3D.js"></script>
<script src="../libraries/three.js-r87/examples/js/shaders/ConvolutionShader.js"></script>
<script src="../libraries/three.js-r87/examples/js/shaders/CopyShader.js"></script>
<script src="../libraries/three.js-r87/examples/js/shaders/FXAAShader.js"></script>
<script src="../libraries/three.js-r87/examples/js/postprocessing/EffectComposer.js"></script>
<script src="../libraries/three.js-r87/examples/js/postprocessing/MaskPass.js"></script>
<script src="../libraries/three.js-r87/examples/js/postprocessing/RenderPass.js"></script>
<script src="../libraries/three.js-r87/examples/js/postprocessing/ShaderPass.js"></script>
<script src="../libraries/three.js-r87/examples/js/postprocessing/BloomPass.js"></script>
<script src="../libraries/three.js-r87/examples/js/Detector.js"></script>
<script src="../libraries/three.js-r87/examples/js/libs/stats.min.js"></script>

        <script>

            if ( ! Detector.webgl ) Detector.addGetWebGLMessage();


            var mouseX = 0, mouseY = 0,
            g=0, j=0,
            
            windowHalfX = window.innerWidth / 2,
            windowHalfY = window.innerHeight / 2,

            camera, scene, renderer, material;

            init();
            animate();
            
            var P, points;

            function init() {

                var i=0, container;

                container = document.createElement( 'div' );
                document.body.appendChild( container );

                camera = new THREE.PerspectiveCamera( 33, window.innerWidth / window.innerHeight, 1, 10000 );
                camera.position.z = 700;

                scene = new THREE.Scene();

                renderer = new THREE.CanvasRenderer();
                renderer.setPixelRatio( window.devicePixelRatio );
                renderer.setSize( window.innerWidth, window.innerHeight );
                container.appendChild( renderer.domElement );

                var geometry3 = new THREE.Geometry(),colors3 = [];
                points = hilbert3D( new THREE.Vector3( 0,0,0 ), 200.0, 1, 0, 1, 2, 3, 4, 5, 6, 7 );
                    

                var starsGeometry = new THREE.BoxGeometry();

                var starsMaterial = new THREE.PointsMaterial( { color: 0x110011 } );


                for ( var i = 0; i < points.length; i ++ ) {
                
                    geometry3.vertices.push( points[ i ] );

                    colors3[ i ] = new THREE.Color( 0xffffff );
                    colors3[ i ].setHSL( i / points.length, 1.0, 0.5 );
                    
                }
                
                P=new THREE.Mesh( starsGeometry, starsMaterial );
                P.position.x=points[0].x;
                P.position.y=points[0].y;
                P.position.z=points[0].z;
                P.scale.set(6,6,6);
                scene.add( P );

                    
                geometry3.colors = colors3;

                // lines

                material = new THREE.LineBasicMaterial( { color: 0xffffff, opacity: 1, linewidth: 3, vertexColors: THREE.VertexColors } );

                var line, p, scale = 1, d = 225;

                line = new THREE.Line(geometry3, material );
                line.scale.x = line.scale.y = line.scale.z =  scale;
                line.position.x = 0;
                line.position.y = 0;
                line.position.z = 0;
                scene.add( line );

                //

                stats = new Stats();
                //container.appendChild( stats.dom );

                //

                document.addEventListener( 'mousemove', onDocumentMouseMove, false );
                document.addEventListener( 'touchstart', onDocumentTouchStart, false );
                document.addEventListener( 'touchmove', onDocumentTouchMove, false );

                //

                window.addEventListener( 'resize', onWindowResize, false );

            }

            function onWindowResize() {

                windowHalfX = window.innerWidth / 2;
                windowHalfY = window.innerHeight / 2;

                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();

                renderer.setSize( window.innerWidth, window.innerHeight );

            }

            //

            function onDocumentMouseMove( event ) {

                mouseX = event.clientX - windowHalfX;
                mouseY = event.clientY - windowHalfY;

            }

            function onDocumentTouchStart( event ) {

                if ( event.touches.length > 1 ) {

                    event.preventDefault();

                    mouseX = event.touches[ 0 ].pageX - windowHalfX;
                    mouseY = event.touches[ 0 ].pageY - windowHalfY;

                }

            }

            function onDocumentTouchMove( event ) {

                if ( event.touches.length == 1 ) {

                    event.preventDefault();

                    mouseX = event.touches[ 0 ].pageX - windowHalfX;
                    mouseY = event.touches[ 0 ].pageY - windowHalfY;
                }

            }

            //

            function animate() {

                render();

                stats.update();
                requestAnimationFrame( animate );
            }

            function render() {
            
                if (  g < points.length-1 ) {
                
                
                    if(j<100){
                    
                        P.position.x=(1-0.01*j)*points[g].x+(0.01*j)*points[g+1].x;
                        P.position.y=(1-0.01*j)*points[g].y+(0.01*j)*points[g+1].y;
                        P.position.z=(1-0.01*j)*points[g].z+(0.01*j)*points[g+1].z;
                        scene.add( P );
                        j++;
                    }
                    else{
                        g++;
                        j=0;
                    }
                    
                }
                
                camera.position.x += ( mouseX - camera.position.x ) * .05;
                camera.position.y += ( - mouseY + 200 - camera.position.y ) * .05;

                camera.lookAt( scene.position );

                var time = 0;//Date.now() * 0.0005;

                for ( var i = 0; i < scene.children.length; i ++ ) {

                    var object = scene.children[ i ];
                    if ( object instanceof THREE.Line ) object.rotation.y = time * ( i % 2 ? 1 : -1 );

                }

                renderer.render(scene, camera );

            }

        </script>
    </body>
</html>